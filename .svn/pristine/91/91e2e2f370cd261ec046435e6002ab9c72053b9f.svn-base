import javafx.collections.FXCollections;
import javafx.collections.ObservableList;

import java.sql.*;

public class Database_controller
{
    static String driver = "com.microsoft.sqlserver.jdbc.SQLServerDriver";

    public static void LoadTheDriver(String driverName)
    {
        System.out.println(System.getenv("APPDATA"));
        System.out.println(System.getProperty("user.home"));


        try
        {
            Class.forName(driverName);
            //System.out.println(driverName + " loaded.");
        }
        catch (ClassNotFoundException e)
        {
            //System.out.println("*** error loading driver *** \n\t" + e);
        }
    }

    public static String[] showDatabaseContent(long Game_ID)
    {
        LoadTheDriver(driver);

        String query = "Select Game_ID, Location FROM Game_exe_locations WHERE Game_ID = " + Game_ID;
        String url = "jdbc:sqlserver://studev.groept.be\\groept";
        String user= "a14_SD405";
        String password = "a14_SD405";
        Connection con = null;
        Statement st = null;
        ResultSet rs = null;
        String temp[];

        try
        {
            con = DriverManager.getConnection(url, user, password);
            //System.out.println("\nUsing driver \"" + DriverManager.getDriver(url).getClass().getName() + "\"\n\n");

            st = con.createStatement();
            rs = st.executeQuery(query);

            rs.next();
            temp = new String[] {rs.getString("Location"), rs.getString("Save_location")};

        }
        catch (SQLException e)
        {
            //System.out.println(e);
            temp = null;
        }
        finally
        {
            try
            {
                if(rs != null)
                    rs.close();
            }
            catch (SQLException e)
            {
            }
        }
        return temp;
    }

    public static void addContent(Long Game_ID, String Location, String Save_location)
    {
        LoadTheDriver(driver);

        String url = "jdbc:sqlserver://studev.groept.be\\groept";
        String user= "a14_SD405";
        String password = "a14_SD405";
        Connection con = null;
        Statement st = null;

        try
        {
            con = DriverManager.getConnection(url, user, password);
            //System.out.println("\nUsing driver \"" + DriverManager.getDriver(url).getClass().getName() + "\"\n\n");

            st = con.createStatement();


            String sql = "INSERT INTO dbo.Game_exe_locations ([Game_ID],[Location], [Save_location]) " + "VALUES (" + Game_ID + ", '" + Location + "', '" + Save_location + "')";
            st.executeUpdate(sql);
            st.close();
        }
        catch (SQLException e)
        {
            //System.out.println(e);
        }
    }

    public static void editContent(Long Game_ID, String Location,String Save_location)
    {
        LoadTheDriver(driver);

        String url = "jdbc:sqlserver://studev.groept.be\\groept";
        String user= "a14_SD405";
        String password = "a14_SD405";
        Connection con = null;
        Statement st = null;
        ResultSet rs = null;

        try
        {
            con = DriverManager.getConnection(url, user, password);
            //System.out.println("\nUsing driver \"" + DriverManager.getDriver(url).getClass().getName() + "\"\n\n");

            st = con.createStatement();

            String query = "Select Game_ID, Location FROM Game_exe_locations WHERE Game_ID = " + Game_ID;
            rs = st.executeQuery(query);

            rs.next();
            rs.getString("Location");

            String sql = "UPDATE dbo.Game_exe_locations SET [Location] = '" + Location +  "', [Save_location] = '" + Save_location +  "'  WHERE Game_ID = " + Game_ID;
            st.executeUpdate(sql);
            st.close();
        }
        catch (SQLException e)
        {
            addContent(Game_ID, Location, Save_location);
        }
    }




}
